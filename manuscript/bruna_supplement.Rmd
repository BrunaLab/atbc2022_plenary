
<!-- --- -->
<!-- title: "Supplement to Bruna: Is there really such a thing as _Tropical_ Biology?" -->
<!-- author: "Emilio M. Bruna" -->
<!-- email: embruna@ufl.edu -->
<!-- web: www.BrunaLab.org -->
<!-- github: embruna -->
<!-- twitter: BrunaLab -->
<!-- phone: "(352) 846-0634" -->
<!-- # date: "`r format(Sys.time(), '%B %Y')`" -->
<!-- geometry: margin=1in -->
<!-- # tables: true -->
<!-- # fontawesome: yes -->
<!-- bibliography      : "ATBC_2022_Plenary.bib" -->
<!-- # csl: "biotropica.csl" -->
<!-- header-includes: -->
<!-- - \usepackage{fancyhdr} -->
<!-- - \pagestyle{fancy} -->
<!-- # - \fancyfoot[C]{\thepage} # remove page number bottom of the page -->
<!-- # - \fancyhead[L]{\scshapeBruna} -->
<!-- # - \fancyhead[R]{\scshapeOn Tropical Biology} -->
<!-- - \usepackage{setspace} -->
<!-- - \usepackage{parskip} -->
<!-- - \usepackage{pdflscape} -->
<!-- - \newcommand{\blandscape}{\begin{landscape}} -->
<!-- - \newcommand{\elandscape}{\end{landscape}} -->

<!-- - \usepackage{caption} -->
<!-- - \DeclareCaptionLabelFormat{Sformat}{#1 S#2} -->
<!-- - \captionsetup[table]{labelformat=Sformat} -->
<!-- - \captionsetup[figure]{labelformat=Sformat} -->

<!-- output: -->
<!--   pdf_document: -->
<!--     keep_tex: true -->
<!--    # html_document: -->
<!--    # df_print: paged -->
<!--    # toc: true -->

<!-- --- -->


```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(gridExtra)
library(kableExtra)
library(here)
library(egg)
# library(citr)
```

\renewcommand{\appendixname}{Supplementary Material}
\renewcommand{\thefigure}{S\arabic{figure}} \setcounter{figure}{0}
\renewcommand{\thetable}{S\arabic{table}} \setcounter{table}{0}
\renewcommand{\theequation}{S\arabic{table}} \setcounter{equation}{0}
\setcounter{page}{1}



<!-- TODO:  -->
<!-- 1. why the peak+declines in TCS, JTE, JEB   -->
<!-- 1. Should yr 1 for analysis be the same for each? YES 1990-2022.  -->
<!-- 1. decide if evolution journals in or out.  -->
<!-- 1.  decide if RBT in or out.  -->
  
```{r biblio_stats, include = FALSE,echo = FALSE,message=FALSE,warning=FALSE}
#
#
# start_yr<-1990
# end_yr<-2022

# How many articles in each journal used in KW analysis
kw_articles <- kw %>%
  group_by(refID, title, PY, jrnl_cat, pub_cat_2) %>%
  tally() %>%
  arrange(jrnl_cat, title, PY) %>%
  group_by(title, PY, jrnl_cat, pub_cat_2) %>%
  tally() %>%
  filter(PY >= start_yr) %>%
  filter(PY <= end_yr) %>%
  rename(`Article Category` = pub_cat_2)

kw_articles_plot <- ggplot(
  kw_articles,
  aes(PY,
    n,
    shape = `Article Category`,
    color = `Article Category`
  )
) +
  scale_shape_manual(values = c(1, 16)) +
  scale_color_manual(values = c("darkblue", "darkgreen")) +
  geom_point()
kw_articles_plot <- kw_articles_plot +
  facet_wrap(vars(title)) +
  theme_bw() +
  theme(
    strip.text = element_text(size = 8, color = "black", face = "italic"),
    axis.text.x = element_text(color = "black", size = 6),
    axis.text.y = element_text(color = "black", size = 6, hjust = 0)
  )
# kw_articles_plot



# How many articles in each publication category used in KW analysis

kw_articles_by_pubcat <- kw %>%
  group_by(refID, PY, pub_cat_2) %>%
  tally() %>%
  arrange(pub_cat_2, PY) %>%
  group_by(PY, pub_cat_2) %>%
  tally() %>%
  filter(PY >= start_yr) %>%
  filter(PY <= end_yr) %>%
  rename(`Article Category` = pub_cat_2)

kw_articles_plot_pubcat <- ggplot(
  kw_articles_by_pubcat,
  aes(PY,
    n,
    shape = `Article Category`,
    color = `Article Category`
  )
) +
  scale_shape_manual(values = c(1, 16)) +
  scale_color_manual(values = c("darkblue", "darkgreen")) +
  geom_point() +
  theme_bw() +
  theme(
    strip.text = element_text(size = 8, color = "black", face = "italic"),
    axis.text.x = element_text(color = "black", size = 6),
    axis.text.y = element_text(color = "black", size = 6, hjust = 0)
  )
# kw_articles_plot_pubcat




# How many articles in each journal used in TW analysis

tw_articles <- tw_all %>%
  group_by(refID, title, PY, jrnl_cat, pub_cat_2) %>%
  tally() %>%
  arrange(jrnl_cat, title, PY) %>%
  group_by(title, PY, jrnl_cat, pub_cat_2) %>%
  tally() %>%
  filter(PY >= start_yr) %>%
  filter(PY <= end_yr) %>%
  rename(`Article Category` = pub_cat_2)

tw_articles_plot <- ggplot(
  tw_articles,
  aes(PY,
    n,
    shape = `Article Category`,
    color = `Article Category`
  )
) +
  scale_shape_manual(values = c(1, 16)) +
  scale_color_manual(values = c("darkblue", "darkgreen")) +
  geom_point() +
  guides(color = guide_legend(title = "Article Category"))
tw_articles_plot <- tw_articles_plot +
  facet_wrap(vars(title)) +
  theme_bw() +
  theme(
    strip.text = element_text(size = 8, color = "black", face = "italic"),
    axis.text.x = element_text(color = "black", size = 6),
    axis.text.y = element_text(color = "black", size = 6, hjust = 0)
  )
# tw_articles_plot



# How many articles in each pubcat used in TW analysis

tw_articles_pubcat <- tw_all %>%
  group_by(refID, PY, pub_cat_2) %>%
  tally() %>%
  arrange(pub_cat_2, PY) %>%
  group_by(PY, pub_cat_2) %>%
  tally() %>%
  filter(PY >= start_yr) %>%
  filter(PY <= end_yr) %>%
  rename(`Article Category` = pub_cat_2)

tw_articles_plot_pubcat <- ggplot(
  tw_articles_pubcat,
  aes(PY,
    n,
    shape = `Article Category`,
    color = `Article Category`
  )
) +
  scale_shape_manual(values = c(1, 16)) +
  scale_color_manual(values = c("darkblue", "darkgreen")) +
  geom_point() +
  theme_bw() +
  theme(
    strip.text = element_text(size = 8, color = "black"),
    axis.text.x = element_text(color = "black", size = 6),
    axis.text.y = element_text(color = "black", size = 6, hjust = 0)
  )
# tw_articles_plot_pubcat
```


## METHODS

### 1. Bibliometric analysis  

\noindent To identify the conceptual domains studied by researchers working in 'Tropical' and "non-Tropical' locations, I used information extracted from the bibliographic records of articles published These studies were published from `r (as.numeric(start_yr))`-`r (as.numeric(end_yr))` in N = `r n_jrnls` journals (_`r titles_string`_). Specifically, I compared (1) article keywords, (2) individual words in article titles (e.g., _seed_, _species_), and (3) title bigrams (i.e., pairs of sequential words in titles, e.g., _seed predation_, _species diversity_). Below I describe how the article records were identified, downloaded, processed, and assigned to the 'Tropical' and "non-Tropical' categories using code written in the `R` statistical programming language [@rcoreteamLanguageEnvironmentStatistical2023] and available at Github (https://github.com/BrunaLab/atbc2022_plenary_talk).  
    On 8 February 2023, I downloaded all bibliographic data available in SCOPUS and the Web of Science 'Core Collection' for all articles published in the focal journals; both SCOPUS and the Web of Science were queried because they differ in the years indexed for each journal. I then used the `refsplitr` package  to process the records and remove any duplicates. After removing all stopwords from article titles [@benoitStopwordsMultilingualStopword2021] and keywords, I spell-checked, stemmed, and lemmatized all of the keywords and title words. I also extracted bigrams from titles with the `tidytext` library [@silgeTidytextTextMining2016]. Finally, I identified each article as either 'Tropical' or 'non-Tropical'; all articles published in (_`r titles_string`_) were assigned to the 'Tropical' category, while articles published in the other journals were assigned to one of these categories based on a search of the titles, keywords, or abstracts for a list of domain-specific terms (e.g., tropical: _amazon_, _andes_, _congo_, _bci_, _chamela_; non-tropical: _finland_, _boreal_, _eastern decid_, _arctic_, _polar_). These procedures resulted in N = `r scales::comma(as.numeric(n_pubs))` total articles published, of which N = `r scales::comma(as.numeric(n_pubs_trop))` reported research conducted in the tropics and N = `r scales::comma(as.numeric(n_pubs_gen))` were based on work conducted in other locations. Collectively, these articles used N = `r scales::comma(as.numeric(n_kw))`, N = `r scales::comma(as.numeric(n_tw))` unique title words, and N = `r scales::comma(as.numeric(bigrams_count))` title bigrams.  

### 2. Visualization  

\noindent The number of articles varies widely between journals, as does the number of keywords per article. Comparing counts of keyword frequency in tropical and non-tropical articles could therefore bias results towards the content published a small number of journals. To correct for this, I calculated the percentage of articles in each geographic category that uising each keyword, title word, or bigram. I then selected the N = `r cutoff` most frequently used terms in each geographic category, and identified (a) any terms that 'tropical' and 'non-tropical' articles had in common, and (b) any terms that were unique to each article category. 

### 3. Data and Code  

\noindent Questions regarding the data set or code should be posted as Issues on the project's Github Repository (https://github.com/BrunaLab/----/issues) or referred to E. M. Bruna. Summaries of any post-publication updates will be posted to the NEWS.md file of the Github Repository (https://github.com/BrunaLab/---)



<!-- \newpage -->


```{=tex}
\blandscape
\newpage
```

```{r keywords, fig.align="center", out.height = "95%",out.width = "95%",fig.cap='The top keywords from articles based on research conducted in (a) the tropics and (b) non-tropical regions and the percentage of articles in each category with those keywords. Keywords based reflecting taxonomy, study systems, and geographic locations are in bold.'} 
# knitr::include_graphics(here("manuscript","figures","plot1.jpeg"))
# knitr::include_graphics("./manuscript/figures/plot1.jpeg")
ggdraw() + draw_image("./manuscript/figures/kw_fig.jpeg", scale = 1)
```

\newpage 

```{r titlewords, fig.align="center", out.height = "200%",out.width = "100%",fig.cap='The top individual title words from articles based on research conducted in (a) the tropics and (b) non-tropical regions and the percentage of articles in each category with those keywords. Title words based reflecting taxonomy, study systems, and geographic locations are in bold.'}
# knitr::include_graphics(here("manuscript","figures","plot1.jpeg"))
# knitr::include_graphics("./manuscript/figures/plot1.jpeg")
ggdraw() + draw_image("./manuscript/figures/tw_fig.jpeg", scale = 1)
```

\newpage

```{r bigrams, fig.align="center", out.height = "100%",out.width = "100%",fig.cap='The top title bigrams from articles based on research conducted in (a) the tropics and (b) non-tropical regions and the percentage of articles in each category with those keywords. Bigrams reflecting taxonomy, study systems, and geographic locations are in bold.',echo = FALSE,message=FALSE,warning=FALSE}
# knitr::include_graphics(here("manuscript","figures","plot1.jpeg"))
# knitr::include_graphics("./manuscript/figures/plot1.jpeg")
ggdraw() + draw_image("./manuscript/figures/bigram_fig.jpeg", scale = 1)
```

```{=tex}
\elandscape
```
\newpage

```{r kwtime, fig.align="center", out.height = "80%",out.width = "80%",fig.cap='For each journal, the number of articles per year from each category that were included in the keyword analysis.',echo = FALSE,message=FALSE,warning=FALSE}
kw_articles_plot
```
\newpage

```{r twtime, fig.align="center", out.height = "80%",out.width = "80%",fig.cap='For each journal, the number of articles per year from each category that were included in the title word analysis.',echo = FALSE,message=FALSE,warning=FALSE}
tw_articles_plot
```
\newpage

# References  



&nbsp;

::: {#refs custom-style="Bibliography"}
:::
